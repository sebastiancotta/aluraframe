{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["Bind","NegociacaoService","Mensagem","MensagemView","Negociacao","NegociacoesView","ListaNegociacoes","DateHelper","NegociacaoController","$","document","querySelector","bind","_data","_quantidade","_valor","_mensagem","_listaNegociacoes","_negociacaoService","_ordemAtual","_init","lista","then","negociacoes","forEach","adiciona","dado","catch","texto","erro","setInterval","console","log","importaNegociacoes","coluna","inverteOrdem","ordena","a","b","event","preventDefault","negociacao","_criaNegociacao","cadastra","mensagem","_limpaCampos","error","importa","apaga","esvazia","textoParaData","value","parseInt","parseFloat"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {Bind} from '../helpers/Bind';\r\nimport {NegociacaoService} from '../services/NegociacaoService';\r\nimport {Mensagem} from '../models/Mensagem';\r\nimport {MensagemView} from '../views/MensagemView';\r\nimport {Negociacao} from '../models/Negociacao';\r\nimport {NegociacoesView} from '../views/NegociacoesView';\r\nimport {ListaNegociacoes} from '../models/ListaNegociacoes';\r\nimport {DateHelper} from '../helpers/DateHelper';\r\n\r\nexport class NegociacaoController {\r\n\tconstructor() {\r\n\t\tlet $ = document.querySelector.bind(document);\r\n\t\tthis._data = $(\"#data\");\r\n\t\tthis._quantidade = $(\"#quantidade\");\r\n\t\tthis._valor = $(\"#valor\");\r\n\t\t\t\t\r\n\t\tthis._mensagem = new Bind(new Mensagem(), new MensagemView($('#mensagemView')), 'texto');\r\n\t\tthis._listaNegociacoes = new Bind(new ListaNegociacoes(), new NegociacoesView($('#negociacoesView')), 'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\t\t\r\n\t\tthis._negociacaoService = new NegociacaoService();\r\n\t\tthis._ordemAtual = ''; // quando a página for carregada, não tem critério. Só passa a ter quando ele começa a clicar nas colunas\r\n\r\n\t\tthis._init();\r\n\t}\r\n\r\n\t_init() {\r\n\t\tthis._negociacaoService\r\n\t\t\t\t.lista()\r\n\t\t\t\t.then(negociacoes => \r\n\t\t\t\t\tnegociacoes.forEach(dado => \r\n\t\t\t\t\t\t\t this._listaNegociacoes.adiciona(\r\n                    \t\t new Negociacao(dado._data, dado._quantidade, dado._valor))))\r\n\t\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t\tsetInterval(() => {\r\n\t\t\tconsole.log('Importando negociações');\r\n\t\t\tthis.importaNegociacoes();\r\n\t\t}, 3000)\t\t\t\t\t\r\n\r\n\t}\r\n\t\r\n\tordena(coluna) {\r\n        if(this._ordemAtual == coluna) {\r\n            this._listaNegociacoes.inverteOrdem();\r\n        } else {\r\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);    \r\n        }\r\n        this._ordemAtual = coluna;\r\n\t}\r\n\t\r\n\tadicionar(event) {\r\n\t\tevent.preventDefault();\r\n\t\t\t\t\t\r\n\t\tlet negociacao = this._criaNegociacao();\r\n\r\n\t\tthis._negociacaoService\t\t\r\n\t\t\t.cadastra(negociacao)\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._limpaCampos();\r\n\t\t\t}).catch(error => this._mensagem.texto = error);\r\n\t}\r\n\t\r\n\timportaNegociacoes() {\r\n        this._negociacaoService\r\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\r\n            .then(negociacoes => negociacoes.forEach(negociacao => {\r\n                this._listaNegociacoes.adiciona(negociacao);\r\n                this._mensagem.texto = 'Negociações do período importadas';   \r\n            }))\r\n            .catch(erro => this._mensagem.texto = erro); \r\n\t}\r\n\t\r\n\tapaga() {\t\t\r\n\t\t\tthis._negociacaoService\r\n\t\t\t.apaga()\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._listaNegociacoes.esvazia();\r\n\t\t\t}).catch(error => this._mensagem.texto = error);\r\n\r\n\t}\r\n\t\r\n\t_criaNegociacao() {\r\n        return new Negociacao(\r\n                DateHelper.textoParaData(this._data.value),\r\n\t\t\t\tparseInt(this._quantidade.value),\r\n\t\t\t\tparseFloat(this._valor.value)\r\n            );   \r\n    }\r\n\t\r\n\t_limpaCampos() {\r\n\t\tthis._data.value = '';\r\n\t\tthis._quantidade.value = 1;\r\n\t\tthis._valor.value = 0.0;\r\n\t}\r\n}"]}